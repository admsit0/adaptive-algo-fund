# AthenAI Preprocessing Configuration
# =====================================
# This config is used by: python -m athenai.scripts.run_preprocess --config configs/preprocess.yaml

preprocess:
  # === Directories ===
  # Path to the raw data folder (datos_competicion)
  root_dir: "datos_competicion"
  
  # Subfolder containing algorithm CSV files
  algos_subdir: "algoritmos"
  
  # Output directories
  cache_dir: "data/cache"
  reports_dir: "data/reports"
  figures_dir: "data/figures"
  
  # === Column Detection ===
  # Candidate column names (tried in order)
  dt_candidates:
    - "datetime"
    - "date"
    - "timestamp"
    - "time"
  
  close_candidates:
    - "close"
    - "Close"
    - "c"
    - "price"
    - "last"
  
  # Datetime parsing formats (tried in order)
  dt_format_candidates:
    - "%Y-%m-%d %H:%M:%S"
    - "%Y-%m-%d %H:%M:%S%.f"
    - "%Y-%m-%dT%H:%M:%S"
    - "%Y-%m-%dT%H:%M:%S%.f"
  
  # === Quality Filters ===
  # Minimum observations for "good" universe
  min_obs: 60
  
  # Minimum coverage ratio (n_obs / span_days)
  min_coverage: 0.70
  
  # Threshold for detecting constant close prices
  constant_close_std_eps: 1.0e-8
  
  # Clip returns beyond this threshold (Â±50%)
  max_abs_ret_clip: 0.50
  
  # === Feature Engineering ===
  # Rolling window sizes for features
  feature_windows:
    - 20   # ~1 month
    - 60   # ~3 months
    - 120  # ~6 months
  
  # Trading days per year (for annualization)
  annualization_factor: 252
  
  # === Output Filenames ===
  panel_name: "algos_panel.parquet"
  meta_name: "algos_meta.parquet"
  meta_good_name: "algos_meta_good.parquet"
  features_name: "algos_features.parquet"
  features_good_name: "algos_features_good.parquet"
  alive_intervals_name: "alive_intervals.parquet"
  
  benchmark_trades_name: "benchmark_trades_clean.parquet"
  benchmark_monthly_name: "benchmark_monthly_clean.parquet"
  benchmark_yearly_name: "benchmark_yearly_clean.parquet"
  benchmark_monthly_stats_name: "benchmark_monthly_stats.parquet"
